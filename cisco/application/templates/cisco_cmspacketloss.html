<!DOCTYPE html>
<html>
<head>
	{% if title %}
        <title>{{ title }} </title>
    {% else %}
        <title>Welcome to UC Report</title>
    {% endif %}
	<script type="text/javascript" src="{{ url_for("static" , filename="jquery-1.9.0.js") }} "></script>
    <script type="text/javascript" charset="utf-8">
    $(function(){
        $('#ExportXLS').click(function(){
            var url='data:application/vnd.ms-excel,' + encodeURIComponent($('#tableWrap').html())
            location.href=url
            return false
        })
    })
    </script>

	<style type="text/css">
        .HeaderLine {
			display: flex;
			flex-flow: row nowrap;
			align-items: center;
			font-family: Verdana;
			font-size: 100%;
			font-weight: bold;
			color: #2f6681;
			height: 60px;
			background: linear-gradient(to right, #ffffff, #2f6681);
		}
		.HeaderItem {
			margin: 5px;
		}

		.NavigationItem {
			margin-left: auto;
			font-size: 80%;
			color: white;
		}

		.HeaderTable {
			border-collapse: collapse;
			text-align: left;
			font-family: Verdana;
			color: white;
			font-weight: bold;
			width: 100%;
			margin-top: 10px;
		}
		.HeaderTable th {
			height: 150px;
			padding: 10px;
			font-size: 130%;
			background: #2f6681;
		}
		.HeaderTable td {
			height: 25px;
			padding: 10px;
			font-size: 80%;
			background: #6d94a7;
		}

		.Status {
			margin: 10;
			margin-top: 10px;
		}

		.StatusHeader {
			font-size: 70%;
			font-weight: bold;
			font-family: Verdana;
			color: black;
		}

		.StatusItem {
			margin: 10;
			font-size: 70%;
			font-family: Verdana;
			color: black;
		}

		.SearchItem {
			margin: 10;
			margin-top: 10px;
			font-size: 80%;
			font-family: Verdana;
			color: black;
		}

		.DataTable {
			font-size: 70%;
			font-family: Verdana;
			color: black;
			width: 100%;
			border-collapse: collapse;
			margin-top: 10px;
		}
		.DataTable TH {
			background: #dbdbdb; /* Цвет фона ячеек */
		}
		.DataTable TR:nth-child(odd) {
			height: 23px;
			background: #f8f8f8;
		}

		.DataTable TR:nth-child(even) {
			height: 23px;
			background: #ebebeb;
		}
	</style>

	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js" integrity="sha384-JpP8FXbgAZLkfur7LiK3j9AGBhHNIvF742meBJrjO2ShJDhCG2I1uVvW+0DUtrmc" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.0.1.min.js" integrity="sha384-xZlADit0Q04ISQEdKg2k3L4W9AwQBAuDs9nJL9fM/WwzL1tEU9VPNezOFX0nLEAz" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.0.1.min.js" integrity="sha384-4BuPRZkdMKSnj3zoxiNrQ86XgNw0rYmBOxe7nshquXwwcauupgBF2DHLVG1WuZlV" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.0.1.min.js" integrity="sha384-Dv1SQ87hmDqK6S5OhBf0bCuwAEvL5QYL0PuR/F1SPVhCS/r/abjkbpKDYL2zeM19" crossorigin="anonymous"></script>
	<script type="text/javascript">
	    Bokeh.set_log_level("info");
	</script>

    {{ resources }}

</head>
<body>
	<div class="HeaderLine">
		<div class="HeaderItem"> 
			<img src="{{ url_for("static", filename="ciscoLogo.gif") }}"/>
		</div>
		<div class="HeaderItem"> 
			Cisco Unified CM Administration
		</div>
		<div class="NavigationItem">
			<form action="" method="post" novalidate>
			    Navigation:
			    {{ formNAV.select_navigation() }}
		        {{ formNAV.submit() }}
			</form>
        </div>
	</div>
	<table class="HeaderTable">
		{% if not rows_list %}
		<tr>
			<th>
				Cisco Meeting Server CDR report
			</th>
		</tr>
		<tr>
			<td>
			</td>
		</tr>
		{% else %}
		<tr>
			<td>
				<button id="ExportXLS">Export to Excel</button>
			</td>
		</tr>
		{% endif %}
	</table>
	<fieldset class="Status">
		<legend class="StatusHeader">Status</legend>
			<div class="StatusItem">
				{{ console_output }}
			</div>
		</legend>
	</fieldset>
	</div>

	{{ div|safe }}
	{{ script|safe }}

	{% if rows_list %}
	<div id="tableWrap">
	<table class="DataTable">
		<tr>
			<th>
				callleg_id
			</th>
			<th>
				AudioPacketLossPercentageRX
			</th>
			<th>
				AudioPacketLossPercentageTX
			</th>
			<th>
				VideoPacketLossPercentageRX
			</th>
			<th>
				VideoPacketLossPercentageTX
			</th>
			<th>
				CMS node
			</th>
		</tr>
		{% for row in rows_list %}
		<tr>
			<td>
				 {{ row.callleg_id }}
			</td>
			<td>
				{{ row.AudioPacketLossPercentageRX }}
			</td>
			<td>
				{{ row.AudioPacketLossPercentageTX }}
			</td>
			<td>
				{{ row.VideoPacketLossPercentageRX }}
			</td>
			<td>
				{{ row.VideoPacketLossPercentageTX }}
			</td>
			<td>
				{{ row.cms_node }}
			</td>
		</tr>
		{% endfor %}
	</table>
	</div>
	{% endif %}
<body>
</html>